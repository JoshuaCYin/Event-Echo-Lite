<!-- Landing Calendar Page -->
<style>
  .landing-calendar-container {
    padding: 2rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .calendar-header {
    text-align: center;
    margin-bottom: 2rem;
  }

  .calendar-header h1 {
    font-size: 2.5rem;
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    margin-bottom: 0.5rem;
  }

  .calendar-header p {
    color: var(--text-secondary);
    font-size: 1.125rem;
  }

  .calendar-wrapper {
    background: var(--bg-primary);
    border-radius: var(--radius-lg);
    padding: 2rem;
    box-shadow: var(--shadow-md);
  }

  @media (max-width: 768px) {
    .landing-calendar-container {
      padding: 1rem;
    }

    .calendar-header h1 {
      font-size: 2rem;
    }

    .calendar-wrapper {
      padding: 1rem;
    }
  }
</style>

<div class="landing-calendar-container">
  <div class="calendar-header">
    <h1>Event Calendar</h1>
    <p>View all upcoming events at a glance</p>
  </div>
  
  <div class="calendar-wrapper">
    <div id="calendar"></div>
  </div>
</div>

<script type="module">
import { api } from "../js/api.js";

async function loadCalendar() {
  try {
    const events = await api("/events/", "GET", null, null);
    
    const calendarEl = document.getElementById("calendar");
    
    const calendar = new window.FullCalendar.Calendar(calendarEl, {
      initialView: "dayGridMonth",
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,listWeek'
      },
      buttonText: {
        today: 'Today',
        month: 'Month',
        week: 'Week',
        list: 'List'
      },
      height: 'auto',
      aspectRatio: 1.8,
      events: events.map(e => ({
        title: e.title,
        start: e.start_time.replace(" ", "T"),
        end: e.end_time.replace(" ", "T"),
        extendedProps: {
          location: e.location,
          description: e.description
        }
      })),
      eventClick: function(info) {
        const event = info.event;
        const startDate = event.start.toLocaleDateString('en-US', {
          weekday: 'long',
          month: 'long',
          day: 'numeric',
          year: 'numeric',
          hour: 'numeric',
          minute: '2-digit'
        });
        
        alert(
          `${event.title}\n\n` +
          `üìÖ ${startDate}\n` +
          `üìç ${event.extendedProps.location || 'Location TBA'}\n\n` +
          `${event.extendedProps.description || ''}\n\n` +
          `Login to RSVP for this event!`
        );
      },
      eventMouseEnter: function(info) {
        info.el.style.opacity = '0.8';
        info.el.style.cursor = 'pointer';
      },
      eventMouseLeave: function(info) {
        info.el.style.opacity = '1';
      }
    });
    
    calendar.render();
    
  } catch (error) {
    console.error("Failed to load calendar:", error);
    document.getElementById("calendar").innerHTML = 
      '<div class="error-message">Failed to load calendar. Please try again.</div>';
  }
}

loadCalendar();
</script>